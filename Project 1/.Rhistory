gg5 = ggplot(filter(police_vio_total, year == 2016), aes(x = reorder(raceethnicity,age.numeric,FUN = mean),
y = age.numeric, fill = raceethnicity )) + geom_boxplot()
gg5 = gg5 + ggtitle("Police Violence in 2016 - Grouped by Race") + xlab('Ethnicity') + ylab("Total Killed") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg6 = ggplot(by_state_merge) + geom_polygon(aes(x = long, y = lat, fill = total, group = group), color = "black") +
scale_fill_gradient(low = 'yellow', high = 'red', name = "Total Killed")
gg6 = gg6 + ggtitle("Police Violence in 2015 & 2016 - By State") + xlab('Longitude') + ylab("Latitude") +
theme(legend.position = 'bottom')
temp = summarise(group_by(by_state_merge,region), long = mean(long), lat = mean(lat))
gg6 + geom_text(data = tem, aes(x = long, y = lat, label = region), size = 5)
library(dplyr)
library(ggplot2)
library(maps)
library(ggthemes)
counties = map_data('county')
states = map_data('state')
armed_func = function() {
}
police_vio_15 = read.csv('2015.csv')
police_vio_16 = read.csv('2016.csv')
state_abb = data.frame(full = state.name,state = state.abb)
police_vio_total = rbind(police_vio_15, police_vio_16)
police_vio_total = inner_join(police_vio_total,state_abb, by = 'state')
police_vio_total = mutate(police_vio_total, age.numeric = as.numeric( as.character(police_vio_total$age) ))
police_vio_total = mutate(police_vio_total, region = as.character(police_vio_total$full))
total_2015 = as.numeric(summarise(filter(police_vio_total, year == 2015), total = sum(n())) )
total_2016 = as.numeric(summarise(filter(police_vio_total, year == 2016), total = sum(n())) )
group_by_race = group_by(police_vio_total,raceethnicity, year)
group_by_armed = group_by(police_vio_total,armed, year)
group_by_classification = group_by(police_vio_total, classification, year)
race_sum = summarise(group_by_race,total = sum(n()))
armed_sum = summarise(group_by_armed, total = sum(n()))
classification_sum = summarise(group_by_classification, total = sum(n()))
race_sum = mutate(race_sum, percentage = ifelse(year == 2015, (total/total_2015)*100, (total/total_2016)*100 ))
armed_sum = mutate(armed_sum, percentage = ifelse(year == 2015, (total/total_2015)*100,
(total/total_2016)*100 ))
classification_sum =  mutate(classification_sum, percentage = ifelse(year == 2015, (total/total_2015)*100,
(total/total_2016)*100 ))
by_state = summarise(group_by(police_vio_total, region), total =
sum(n()))
by_state$region = tolower(by_state$region)
by_state_merge = inner_join(states, by_state, by = 'region')
gg1 = ggplot(race_sum, aes(x = reorder(raceethnicity,total,median), y = total)) + geom_bar(aes(fill = as.factor(year)),
stat = 'identity', position =
'dodge')
gg1 = gg1 + ggtitle('Police Violence in 2015 & 2016 - By Race') + xlab('Ethnicity') + ylab('Total killed') +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
gg2 = ggplot(armed_sum, aes(x = reorder(armed,total,median), y = total)) + geom_bar(aes(fill = as.factor(year)),
stat = 'identity', position =
'dodge')
gg2 = gg2 + ggtitle("Police Violence in 2015 & 2016 - By Weapon") + xlab("Weapon of use") + ylab("Total Killed") +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
gg3 = ggplot(classification_sum, aes(x = reorder(classification,total, median), y = total)) + geom_bar(aes(fill = as.factor(year)),
stat = 'identity', position =
'dodge')
gg3 = gg3 + ggtitle("Police Violence in 2015 & 2016 - by Classification") + xlab("Classification") + ylab("Total Killed") +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
gg4 = ggplot(filter(police_vio_total, year == 2015), aes(x = reorder(raceethnicity,age.numeric,median),
y = age.numeric, fill = raceethnicity )) + geom_boxplot()
gg4 = gg4 + ggtitle("Police Violence in 2015 - Grouped by Race") + xlab('Ethnicity') + ylab("Total Killed") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg5 = ggplot(filter(police_vio_total, year == 2016), aes(x = reorder(raceethnicity,age.numeric,FUN = mean),
y = age.numeric, fill = raceethnicity )) + geom_boxplot()
gg5 = gg5 + ggtitle("Police Violence in 2016 - Grouped by Race") + xlab('Ethnicity') + ylab("Total Killed") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg6 = ggplot(by_state_merge) + geom_polygon(aes(x = long, y = lat, fill = total, group = group), color = "black") +
scale_fill_gradient(low = 'yellow', high = 'red', name = "Total Killed")
gg6 = gg6 + ggtitle("Police Violence in 2015 & 2016 - By State") + xlab('Longitude') + ylab("Latitude") +
theme(legend.position = 'bottom')
temp = summarise(group_by(by_state_merge,region), long = mean(long), lat = mean(lat))
gg6 + geom_text(data = temp, aes(x = long, y = lat, label = region), size = 5)
gg6
library(dplyr)
library(ggplot2)
library(maps)
library(ggthemes)
counties = map_data('county')
states = map_data('state')
armed_func = function() {
}
police_vio_15 = read.csv('2015.csv')
police_vio_16 = read.csv('2016.csv')
state_abb = data.frame(full = state.name,state = state.abb)
police_vio_total = rbind(police_vio_15, police_vio_16)
police_vio_total = inner_join(police_vio_total,state_abb, by = 'state')
police_vio_total = mutate(police_vio_total, age.numeric = as.numeric( as.character(police_vio_total$age) ))
police_vio_total = mutate(police_vio_total, region = as.character(police_vio_total$full))
total_2015 = as.numeric(summarise(filter(police_vio_total, year == 2015), total = sum(n())) )
total_2016 = as.numeric(summarise(filter(police_vio_total, year == 2016), total = sum(n())) )
group_by_race = group_by(police_vio_total,raceethnicity, year)
group_by_armed = group_by(police_vio_total,armed, year)
group_by_classification = group_by(police_vio_total, classification, year)
race_sum = summarise(group_by_race,total = sum(n()))
armed_sum = summarise(group_by_armed, total = sum(n()))
classification_sum = summarise(group_by_classification, total = sum(n()))
race_sum = mutate(race_sum, percentage = ifelse(year == 2015, (total/total_2015)*100, (total/total_2016)*100 ))
armed_sum = mutate(armed_sum, percentage = ifelse(year == 2015, (total/total_2015)*100,
(total/total_2016)*100 ))
classification_sum =  mutate(classification_sum, percentage = ifelse(year == 2015, (total/total_2015)*100,
(total/total_2016)*100 ))
by_state = summarise(group_by(police_vio_total, region), total =
sum(n()))
by_state$region = tolower(by_state$region)
by_state_merge = inner_join(states, by_state, by = 'region')
gg1 = ggplot(race_sum, aes(x = reorder(raceethnicity,total,median), y = total)) + geom_bar(aes(fill = as.factor(year)),
stat = 'identity', position =
'dodge')
gg1 = gg1 + ggtitle('Police Violence in 2015 & 2016 - By Race') + xlab('Ethnicity') + ylab('Total killed') +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
gg2 = ggplot(armed_sum, aes(x = reorder(armed,total,median), y = total)) + geom_bar(aes(fill = as.factor(year)),
stat = 'identity', position =
'dodge')
gg2 = gg2 + ggtitle("Police Violence in 2015 & 2016 - By Weapon") + xlab("Weapon of use") + ylab("Total Killed") +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
gg3 = ggplot(classification_sum, aes(x = reorder(classification,total, median), y = total)) + geom_bar(aes(fill = as.factor(year)),
stat = 'identity', position =
'dodge')
gg3 = gg3 + ggtitle("Police Violence in 2015 & 2016 - by Classification") + xlab("Classification") + ylab("Total Killed") +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
gg4 = ggplot(filter(police_vio_total, year == 2015), aes(x = reorder(raceethnicity,age.numeric,median),
y = age.numeric, fill = raceethnicity )) + geom_boxplot()
gg4 = gg4 + ggtitle("Police Violence in 2015 - Grouped by Race") + xlab('Ethnicity') + ylab("Total Killed") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg5 = ggplot(filter(police_vio_total, year == 2016), aes(x = reorder(raceethnicity,age.numeric,FUN = mean),
y = age.numeric, fill = raceethnicity )) + geom_boxplot()
gg5 = gg5 + ggtitle("Police Violence in 2016 - Grouped by Race") + xlab('Ethnicity') + ylab("Total Killed") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg6 = ggplot(by_state_merge) + geom_polygon(aes(x = long, y = lat, fill = total, group = group), color = "black") +
scale_fill_gradient(low = 'yellow', high = 'red', name = "Total Killed")
gg6 = gg6 + ggtitle("Police Violence in 2015 & 2016 - By State") + xlab('Longitude') + ylab("Latitude") +
theme(legend.position = 'bottom')
temp = summarise(group_by(by_state_merge,region), long = mean(long), lat = mean(lat))
gg6 + geom_text(data = temp, aes(x = long, y = lat, label = region), size = 5)
gg6 + geom_text(data = temp, aes(x = long, y = lat, label = region), size = 5)
head(by_state_merge)
head(by_state)
head(police_vio_total)
head(states)
head(by_state)
head(by_state_merge)
t1 = summarise(group_by(police_vio_total, region,year), total = sum(n()))
head(t1,10)
t1$region = tolower(t1$region)
head(t1,10)
t1 = inner_join(states, t1, by = 'region')
head(t1)
ggplot(t1) + geom_polygon(aes(x = long, y = lat, fill = total, group= group), color = 'black') +
scale_fill_gradient(low = 'yellow', high = 'red', name = 'Totak Killed') + facet_grid(. ~ year)
scale_fill_gradient(low = 'yellow', high = 'red', name = 'Totak Killed') + facet_grid(. ~ year) +
geom_text(data = temp, aes(x = long, y = lat, label = region), size = 5)
ggplot(t1) + geom_polygon(aes(x = long, y = lat, fill = total, group= group), color = 'black') +
scale_fill_gradient(low = 'yellow', high = 'red', name = 'Totak Killed') +
geom_text(data = temp, aes(x = long, y = lat, label = region), size = 5)+ facet_grid(. ~ year)
head(counties)
head(police_vio_15)
head(police_vio_total)
select(police_vio_total, region, state)
t2 = summarise(group_by(police_vio_total,region, state, year), total= sum(n()))
head(t2)
t2$region = tolower(t2$region)
head(t2)
t2 = inner_join(states, t2, by = 'region')
head(t2)
ggplot(data = t2) + geom_polygon(aes(x = long, y = lat, fill = total, group= group), color = 'black') +
scale_fill_gradient(low = 'yellow', high = 'red', name = 'Totak Killed') + facet_grid(. ~ year) +
temp1 = summarise(group_by(t2, region, state), long = mean(long), lat = mean(lat))
head(temp1)
ggplot(data = t2) + geom_polygon(aes(x = long, y = lat, fill = total, group= group), color = 'black') +
scale_fill_gradient(low = 'yellow', high = 'red', name = 'Total Killed') +
geom_text(data = temp1, aes(x = long, y = lat, label = state), size = 5)+ facet_grid(. ~ year)
temp1 = summarise(group_by(t2, region, state), long = sum(long)/n(), lat = sum(lat)/n())
head(temp1)
ggplot(data = t2) + geom_polygon(aes(x = long, y = lat, fill = total, group= group), color = 'black') +
scale_fill_gradient(low = 'yellow', high = 'red', name = 'Total Killed') +
geom_text(data = temp1, aes(x = long, y = lat, label = state), size = 5)+ facet_grid(. ~ year)
library(dplyr)
library(ggplot2)
library(maps)
library(ggthemes)
counties = map_data('county')
states = map_data('state')
armed_func = function() {
}
police_vio_15 = read.csv('2015.csv')
police_vio_16 = read.csv('2016.csv')
state_abb = data.frame(full = state.name,state = state.abb)
police_vio_total = rbind(police_vio_15, police_vio_16)
police_vio_total = inner_join(police_vio_total,state_abb, by = 'state')
police_vio_total = mutate(police_vio_total, age.numeric = as.numeric( as.character(police_vio_total$age) ))
police_vio_total = mutate(police_vio_total, region = as.character(police_vio_total$full))
total_2015 = as.numeric(summarise(filter(police_vio_total, year == 2015), total = sum(n())) )
total_2016 = as.numeric(summarise(filter(police_vio_total, year == 2016), total = sum(n())) )
group_by_race = group_by(police_vio_total,raceethnicity, year)
group_by_armed = group_by(police_vio_total,armed, year)
group_by_classification = group_by(police_vio_total, classification, year)
race_sum = summarise(group_by_race,total = sum(n()))
armed_sum = summarise(group_by_armed, total = sum(n()))
classification_sum = summarise(group_by_classification, total = sum(n()))
race_sum = mutate(race_sum, percentage = ifelse(year == 2015, (total/total_2015)*100, (total/total_2016)*100 ))
armed_sum = mutate(armed_sum, percentage = ifelse(year == 2015, (total/total_2015)*100,
(total/total_2016)*100 ))
classification_sum =  mutate(classification_sum, percentage = ifelse(year == 2015, (total/total_2015)*100,
(total/total_2016)*100 ))
by_state = summarise(group_by(police_vio_total, region, state, year), total =
sum(n()))
by_state$region = tolower(by_state$region)
by_state_merge = inner_join(states, by_state, by = 'region')
gg1 = ggplot(race_sum, aes(x = reorder(raceethnicity,total,median), y = total)) + geom_bar(aes(fill = as.factor(year)),
stat = 'identity', position =
'dodge')
gg1 = gg1 + ggtitle('Police Violence in 2015 & 2016 - By Race') + xlab('Ethnicity') + ylab('Total killed') +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
gg2 = ggplot(armed_sum, aes(x = reorder(armed,total,median), y = total)) + geom_bar(aes(fill = as.factor(year)),
stat = 'identity', position =
'dodge')
gg2 = gg2 + ggtitle("Police Violence in 2015 & 2016 - By Weapon") + xlab("Weapon of use") + ylab("Total Killed") +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
gg3 = ggplot(classification_sum, aes(x = reorder(classification,total, median), y = total)) + geom_bar(aes(fill = as.factor(year)),
stat = 'identity', position =
'dodge')
gg3 = gg3 + ggtitle("Police Violence in 2015 & 2016 - by Classification") + xlab("Classification") + ylab("Total Killed") +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
gg4 = ggplot(filter(police_vio_total, year == 2015), aes(x = reorder(raceethnicity,age.numeric,median),
y = age.numeric, fill = raceethnicity )) + geom_boxplot()
gg4 = gg4 + ggtitle("Police Violence in 2015 - Grouped by Race") + xlab('Ethnicity') + ylab("Total Killed") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg5 = ggplot(filter(police_vio_total, year == 2016), aes(x = reorder(raceethnicity,age.numeric,FUN = mean),
y = age.numeric, fill = raceethnicity )) + geom_boxplot()
gg5 = gg5 + ggtitle("Police Violence in 2016 - Grouped by Race") + xlab('Ethnicity') + ylab("Total Killed") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg6 = ggplot(by_state_merge) + geom_polygon(aes(x = long, y = lat, fill = total, group = group), color = "black") +
scale_fill_gradient(low = 'yellow', high = 'red', name = "Total Killed")
gg6 = gg6 + ggtitle("Police Violence in 2015 & 2016 - By State") + xlab('Longitude') + ylab("Latitude") +
theme(legend.position = 'bottom')
temp = summarise(group_by(by_state_merge,region,state), long = mean(long), lat = mean(lat))
gg6 + geom_text(data = temp, aes(x = long, y = lat, label = state), size = 5)
+ facet_grid(. ~ year)
head(temp)
head(by_state_merge)
head(temp1)
gg6 + geom_text(data = temp, aes(x = long, y = lat, label = state), size = 5)
gg6 + geom_text(data = temp, aes(x = long, y = lat, label = state), size = 5) + facet_grid(. ~ year)
ggplot(data = police_vio_total) + geom_boxplot(aes(x = reorder(raceethnicity, age.numeric, mean), y = age.numeric, fill = raceethnicity)) + facet_grid(. ~ year)
ggplot(data = police_vio_total) + geom_boxplot(aes(x = reorder(raceethnicity, age.numeric, median), y = age.numeric, fill = raceethnicity)) + facet_grid(. ~ year)
gg4 = ggplot(data = police_vio_total) +
geom_boxplot(aes(x = reorder(raceethnicity, age.numeric, median), y = age.numeric, fill = raceethnicity)) +facet_grid(. ~ year)
gg4 = gg4 + ggtitle("Police Violence in 2015 - Grouped by Race") + xlab('Ethnicity') + ylab("Total Killed") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg4
gg4 = ggplot(data = police_vio_total) +
geom_boxplot(aes(x = reorder(raceethnicity, age.numeric, median), y = age.numeric, fill = raceethnicity), na.rm = TRUE, varwidth = TRUE) +
facet_grid(. ~ year)
gg4 = gg4 + ggtitle("Police Violence in 2015 - Grouped by Race") + xlab('Ethnicity') + ylab("Total Killed") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg4
gg4 = ggplot(data = police_vio_total) +
geom_boxplot(aes(x = reorder(raceethnicity, age.numeric, median), y = age.numeric, fill = raceethnicity), na.rm = TRUE, varwidth = TRUE, notch = TRUE) +
facet_grid(. ~ year)
gg4 = gg4 + ggtitle("Police Violence in 2015 - Grouped by Race") + xlab('Ethnicity') + ylab("Total Killed") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg4
head(police_vio_total)
ggplot(data = police_vio_total) + geom_bar(aes(x = raceethnicity, y = age.numeric, fill = as.factor(year)), stat = 'identity', position = 'dodge') + facet_grid(. ~ gender)
ggplot(data = police_vio_total) + geom_bar(aes(x = reorder(raceethnicity, age.numeric mean), y = age.numeric, fill = as.factor(year)), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(. ~ gender)
ggplot(data = police_vio_total) + geom_bar(aes(x = reorder(raceethnicity, age.numeric, mean), y = age.numeric, fill = as.factor(year)), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(. ~ gender)
gg4
gg4 = ggplot(data = police_vio_total) +
geom_boxplot(aes(x = reorder(raceethnicity, age.numeric, median), y = age.numeric, fill = raceethnicity), na.rm = TRUE, varwidth = TRUE, notch = FALSE) +
facet_grid(. ~ year)
gg4 = gg4 + ggtitle("Police Violence in 2015 - Grouped by Race") + xlab('Ethnicity') + ylab("Total Killed") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg4
ggplot(data = police_vio_total) + geom_bar(aes(x = reorder(raceethnicity, age.numeric, mean), y = age.numeric, fill = as.factor(year)), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ gender)
ggplot(data = police_vio_total) + geom_bar(aes(x = reorder(raceethnicity, age.numeric, mean), y = age.numeric, fill = raceethnicity, stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ gender)
ggplot(data = police_vio_total) + geom_bar(aes(x = reorder(raceethnicity, age.numeric, mean), y = age.numeric, fill = raceethnicity), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ gender)
ggplot(data = filter(police_vio_total, raceethnicity != 'Non-conforming')) + geom_bar(aes(x = reorder(raceethnicity, age.numeric, mean), y = age.numeric, fill = raceethnicity), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ gender)
ggplot(data = filter(police_vio_total, gender != 'Non-conforming')) + geom_bar(aes(x = reorder(raceethnicity, age.numeric, mean), y = age.numeric, fill = raceethnicity), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ gender)
head(filter(police_vio_total, gender !='Non-conforming'))
ggplot(data = filter(police_vio_total, gender != 'Non-conforming')) + geom_bar(aes(x = reorder(raceethnicity, age.numeric, mean), y = age.numeric, fill = raceethnicity), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ gender)
ggplot(data = filter(police_vio_total, gender != 'Non-conforming')) + geom_bar(aes(x = reorder(raceethnicity, age.numeric, mean), y = age.numeric, fill = raceethnicity), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ armed)
gg2
as.factor((police_vio_total$raceethnicity))
levels(as.factor((police_vio_total$raceethnicity)))
levels(as.factor((police_vio_total$armed)))
ggplot(data = filter(police_vio_total, gender != 'Non-conforming')) + geom_bar(aes(x = reorder(armed, age.numeric, mean), y = age.numeric, fill = raceethnicity), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ raceethnicity)
head(race_sum)
head(arrange(race_sum), total)
head(arrange(race_sum, total))
head(arrange(race_sum, desc(total) ))
ggplot(data = filter(police_vio_total, gender != 'Non-conforming', raceethnicity = c('White', 'Black', 'Hispanic/Latino'))) + geom_bar(aes(x = reorder(armed, age.numeric, mean), y = age.numeric, fill = raceethnicity), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ raceethnicity)
ggplot(data = filter(police_vio_total, gender != 'Non-conforming', raceethnicity == c('White', 'Black', 'Hispanic/Latino'))) + geom_bar(aes(x = reorder(armed, age.numeric, mean), y = age.numeric, fill = raceethnicity), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ raceethnicity)
gg1
ggplot(data = filter(police_vio_total, gender != 'Non-conforming', raceethnicity == c('White', 'Black', 'Hispanic/Latino'))) + geom_bar(aes(x = reorder(classification, age.numeric, mean), y = age.numeric, fill = raceethnicity), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ raceethnicity)
colnames(police_vio_total)
summarise(police_vio_total, sum = sum(n()))
summarise(filter(police_vio_total, raceethnicity == c('White', 'Black','Hispanic/Latino')), sum = sum(n()))
gg1
head(filter(police_vio_total, raceethnicity == c('White', 'Black','Hispanic/Latino')), sum = sum(n()))
str(filter(police_vio_total, raceethnicity == c('White', 'Black','Hispanic/Latino')), sum = sum(n()))
colnames(filter(police_vio_total, raceethnicity == c('White', 'Black','Hispanic/Latino')), sum = sum(n()))
head(summarise(filter(police_vio_total, raceethnicity == c('White', 'Black','Hispanic/Latino')), sum = sum(n())))
head(summarise(group_by(filter(police_vio_total, raceethnicity == c('White', 'Black','Hispanic/Latino')), raceethnicity), sum = sum(n()))
)
head(summarise(group_by(police_vio_total, raceethnicity), sum = sum(n())))
head(summarise(group_by(police_vio_total, raceethnicity), sum = sum(n())),10)
head(summarise(group_by(filter(police_vio_total, gender == c('Non-conforming')), raceethnicity), sum = sum(n()))
)
head(summarise(group_by(filter(police_vio_total, gender != c('Non-conforming')), raceethnicity), sum = sum(n())))
head(summarise(group_by(filter(police_vio_total, gender != c('Non-conforming')), raceethnicity), sum = sum(n())),10)
head(summarise(group_by(filter(police_vio_total, raceethnicity != c('White','Black','Hispanic/Latino')), raceethnicity), sum = sum(n())),10)
summarise((group_by(police_vio_total, raceethnicity == c('White','Black','Hispanic/Latino'))))
summarise((group_by(police_vio_total, raceethnicity == c('White','Black','Hispanic/Latino'))), sum = sum(n()))
filter(police_vio_total, raceethnicity == c('White','Black','Hispanic/Latino'))
summarise(group_by(filter(police_vio_15, raceethnicity == c('White','Black','Hispanic/Latino')),raceethnicity), sum = sum(n())
)
head(summarise(group_by(police_vio_total, raceethnicity), sum = sum(n())),10)
head(summarise(group_by(police_vio_total, raceethnicity), sum = sum(n())),15)
filter(summarise(group_by(police_vio_total, raceethnicity), sum = sum(n())), raceethnicity == c('White','Black','Hispanic/Latino')
)
filter(summarise(group_by(police_vio_total, raceethnicity), sum = sum(n())), raceethnicity == c('White','Black','Hispanic/Latino'))
str(police_vio_total)
t3 = police_vio_total
t3$raceethnicity = as.character((t3$raceethnicity))
filter(t3, raceethnicity == c('White','Black','Hispanic/Latino'))
str(t3)
t3_temp = filter(t3, raceethnicity == c("White","Black","Hispanic/Latino"))
length(t3)
head(t3)
dim(t3)
dim(t3_temp)
t3_temp = filter(t3, raceethnicity == c("White"))
dim(t3_temp)
t3_temp = filter(t3, raceethnicity == c("White", "Black"))
dim(t3_temp)
t3_temp = filter(t3, raceethnicity %in% c("White", "Black"))
dim(t3_temp)
t3_temp = filter(police_vio_total, raceethnicity %in% c("White", "Black"))
dim(t3_temp)
summarise(filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino")), sum = sum(n()))
summarise(group_by(police_vio_total, raceethnicity), sum = sum(n()))
1150+556+378
2084/2204
ggplot(data = filter(police_vio_total, gender != 'Non-conforming', raceethnicity == c('White', 'Black', 'Hispanic/Latino'))) + geom_bar(aes(x = reorder(classification, age.numeric, mean), y = age.numeric, fill = raceethnicity), stat = 'identity', position = 'dodge', na.rm = TRUE) + facet_grid(year ~ raceethnicity)
data1 = group_by(filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino")), raceethnicity, armed)
gg2 = ggplot(data = summarise(data1, total = sum(n()))) +
geom_bar(aes(x = armed, y = total, fill = raceethnicity), stat = 'identity', position = 'dodge')
gg2
gg2 = ggplot(data = summarise(data1, total = sum(n()))) +
geom_bar(aes(x = armed, y = total, fill = raceethnicity), stat = 'identity', position = 'dodge') + facet_grid(. ~ year)
gg2
gg2 = ggplot(data = summarise(data1, total = sum(n()))) +
geom_bar(aes(x = armed, y = total, fill = year), stat = 'identity', position = 'dodge') + facet_grid(. ~ year)
gg2
gg2 = ggplot(data = data1) +
geom_bar(aes(x = armed, fill = raceethnicity), position = 'dodge') + facet_grid(. ~ year)
gg2
?count
gg2 = ggplot(data = data1) +
geom_bar(aes(x = armed, fill = raceethnicity), position = 'dodge') + facet_grid(raceethnicity ~ year)
gg2
gg2 = ggplot(data = data1) +
geom_bar(aes(x = reorder(armed,count), fill = raceethnicity), position = 'dodge') + facet_grid(raceethnicity ~ year)
gg2
gg2 = ggplot(data = data1) +
geom_bar(aes(x = reorder(armed,count, mean), fill = raceethnicity), position = 'dodge') + facet_grid(raceethnicity ~ year)
gg2
gg2 = ggplot(data = data1) +
geom_bar(aes(x = armed, fill = raceethnicity), position = 'dodge') + facet_grid(. ~ year)
gfg2
gg2
gg2 = gg2 + ggtitle("Police Violence in 2015 & 2016 - By Weapon") + xlab("Weapon of use") + ylab("Total Killed") +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
gg2
data2 = group_by(filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino")), raceethnicity, classification)
gg3 = ggplot(data = data2) +
geom_bar(aes(x = classification, fill = raceethnicity), position = 'dodge') + facet_grid(. ~ year)
gg3
gg3 = gg3 + ggtitle("Police Violence in 2015 & 2016 - by Classification") + xlab("Classification") + ylab("Total Killed") +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
gg3
gg4
gg4 = ggplot(data = police_vio_total) +
geom_boxplot(aes(x = reorder(raceethnicity, age.numeric, median), y = age.numeric, fill = raceethnicity), na.rm = TRUE, varwidth = TRUE, notch = FALSE) +
facet_grid(. ~ year)
gg4 = gg4 + ggtitle("Police Violence in 2015 - Grouped by Race") + xlab('Ethnicity') + ylab("Age") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
gg4
gg1
gg2
gg5 = ggplot(by_state_merge) + geom_polygon(aes(x = long, y = lat, fill = total, group = group), color = "black") +
scale_fill_gradient(low = 'yellow', high = 'red', name = "Total Killed")
gg5 = gg5 + ggtitle("Police Violence in 2015 & 2016 - By State") + xlab('Longitude') + ylab("Latitude") +
theme(legend.position = 'bottom')
temp = summarise(group_by(by_state_merge,region,state), long = mean(long), lat = mean(lat))
gg5 + geom_text(data = temp, aes(x = long, y = lat, label = state), size = 5) + facet_grid(. ~ year)
gg5
gg5 + geom_text(data = temp, aes(x = long, y = lat, label = state), size = 5) + facet_grid(. ~ year)
ggplot(data = police_vio_total) + geom_bar(aes(x = armed, fill = raceethnicity), position = 'dodge') + facet_wrap(. ~ classification)
ggplot(data = police_vio_total) + geom_bar(aes(x = armed, fill = raceethnicity), position = 'dodge')
colnames(police_vio_total)
ggplot(data = police_vio_total) + geom_bar(aes(x = armed, fill = raceethnicity), position = 'dodge') + facet_wrap(. ~ year)
ggplot(data = police_vio_total) + geom_bar(aes(x = armed, fill = raceethnicity), position = 'dodge') + facet_grid(. ~ year)
ggplot(data = police_vio_total) + geom_bar(aes(x = armed, fill = raceethnicity), position = 'dodge') + facet_wrap(. ~ classification)
ggplot(data = police_vio_total) + geom_bar(aes(x = armed, fill = raceethnicity), position = 'dodge') + facet_grid(. ~ classification)
ggplot(data = police_vio_total) + geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(armed ~ classification)
ggplot(data = filter(police_vio_total, raceethnicity %in% c("White","Black","Hispanic/Latino"))) + geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(armed ~ classification)
ggplot(data = filter(police_vio_total, raceethnicity %in% c("White","Black","Hispanic/Latino"))) + geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(armed ~ classification %in% c("Gunshot"))
ggplot(data = filter(police_vio_total, raceethnicity %in% c("White","Black","Hispanic/Latino"), classification %in% c("Gunshot"), armed %in% c("No"))) + geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(armed ~ classification)
ggplot(data = filter(police_vio_total, raceethnicity %in% c("White","Black","Hispanic/Latino"), classification %in% c("Gunshot")) + geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(armed ~ classification)
ggplot(data = filter(police_vio_total, raceethnicity %in% c("White","Black","Hispanic/Latino"), classification %in% c("Gunshot"))) + geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(armed ~ classification)
gg2
gg3
gg4
gg1
head(race_sum)
ggplot(data = filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino"))) + geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(sex ~ year)
colnames(police_vio_total)
ggplot(data = filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino"))) + geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(gender ~ year)
ggplot(data = filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino"), gender %in% c(!"Non-conforming"))) + geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(gender ~ year)
ggplot(data = filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino"), gender != "Non-conforming")) + geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(gender ~ year)
library(dplyr)
library(ggplot2)
library(maps)
library(ggthemes)
counties = map_data('county')
states = map_data('state')
armed_func = function() {
}
police_vio_15 = read.csv('2015.csv')
police_vio_16 = read.csv('2016.csv')
state_abb = data.frame(full = state.name,state = state.abb)
police_vio_total = rbind(police_vio_15, police_vio_16)
police_vio_total = inner_join(police_vio_total,state_abb, by = 'state')
police_vio_total = mutate(police_vio_total, age.numeric = as.numeric( as.character(police_vio_total$age) ))
police_vio_total = mutate(police_vio_total, region = as.character(police_vio_total$full))
total_2015 = as.numeric(summarise(filter(police_vio_total, year == 2015), total = sum(n())) )
total_2016 = as.numeric(summarise(filter(police_vio_total, year == 2016), total = sum(n())) )
group_by_race = group_by(police_vio_total,raceethnicity, year)
group_by_armed = group_by(police_vio_total,armed, year)
group_by_classification = group_by(police_vio_total, classification, year)
race_sum = summarise(group_by_race,total = sum(n()))
armed_sum = summarise(group_by_armed, total = sum(n()))
classification_sum = summarise(group_by_classification, total = sum(n()))
race_sum = mutate(race_sum, percentage = ifelse(year == 2015, (total/total_2015)*100, (total/total_2016)*100 ))
armed_sum = mutate(armed_sum, percentage = ifelse(year == 2015, (total/total_2015)*100,
(total/total_2016)*100 ))
classification_sum =  mutate(classification_sum, percentage = ifelse(year == 2015, (total/total_2015)*100,
(total/total_2016)*100 ))
by_state = summarise(group_by(police_vio_total, region, state, year), total =
sum(n()))
by_state$region = tolower(by_state$region)
by_state_merge = inner_join(states, by_state, by = 'region')
gg5 = ggplot(by_state_merge) + geom_polygon(aes(x = long, y = lat, fill = total, group = group), color = "black") +
scale_fill_gradient(low = 'yellow', high = 'red', name = "Total Killed")
gg5 = gg5 + ggtitle("Police Violence in 2015 & 2016 - By State") + xlab('Longitude') + ylab("Latitude") +
theme(legend.position = 'bottom')
temp = summarise(group_by(by_state_merge,region,state), long = mean(long), lat = mean(lat))
gg5 + geom_text(data = temp, aes(x = long, y = lat, label = state), size = 5) + facet_grid(. ~ year)
gg1 = ggplot(race_sum, aes(x = reorder(raceethnicity,total,median), y = total)) + geom_bar(aes(fill = as.factor(year)),
stat = 'identity', position =
'dodge')
gg1 = gg1 + ggtitle('Police Violence in 2015 & 2016 - By Race') + xlab('Ethnicity') + ylab('Total killed') +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
ggplot(data = summarise(group_by(police_vio_total, raceethnicity, year), Year_total = sum(n())) ) +
geom_bar(aes(x = reorder(raceethnicity, Year_total), y = Year_total, fill = raceethnicity ), stat = 'identity') +
facet_grid(. ~ year) + ggtitle('Police Violence - Grouped by year and Race') +
xlab('Ethnicity') + ylab('Total Killed') + theme(legend.position = 'bottom') +
scale_fill_discrete(name = 'Ethnicity')
ggplot(data = summarise(group_by(filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino"), gender != "Non-conforming"), raceethnicity, year, gender), total = sum(n()) ) )+
geom_bar(aes(x = reorder(raceethnicity, total, mean), y = total, fill = raceethnicity), stat = 'identity', position = 'dodge') +
facet_grid(gender ~ year) +
theme(legend.position = 'bottom') + ggtitle('Police Violence in 2015 & 2016 - Grouped by gender') +
xlab('Ethnicity') + ylab("Total Killed") + scale_fill_discrete(name = "Ethnicity")
data1 = group_by(filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino"), gender == 'Male' ), raceethnicity, armed, year)
data1 = summarise(data1, total = sum(n()))
gg2 = ggplot(data = data1) +
geom_bar(aes(x = reorder(armed, total, mean), y = total, fill = raceethnicity), stat = 'identity', position = 'dodge') +
facet_grid(. ~ year)
gg2 = gg2 + ggtitle("Police Violence in 2015 & 2016 - By Weapon") + xlab("Weapon of use") + ylab("Total Killed") +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
data2 = group_by(filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino"), gender== "Male"), raceethnicity, classification, year)
data2 = summarise(data2, total = sum(n()))
gg3 = ggplot(data = data2) +
geom_bar(aes(x = reorder(classification, total, mean), y = total, fill = raceethnicity), position = 'dodge', stat = 'identity') +
facet_grid(. ~ year)
gg3 = gg3 + ggtitle("Police Violence in 2015 & 2016 - by Classification") + xlab("Classification") + ylab("Total Killed") +
theme(legend.position = "bottom") + scale_fill_discrete(name = "Year")
data3 = group_by(filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino"), gender== "Male"), raceethnicity)
gg4 = ggplot(data = data3) +
geom_boxplot(aes(x = reorder(raceethnicity, age.numeric, median), y = age.numeric, fill = raceethnicity), na.rm = TRUE, varwidth = TRUE, notch = FALSE) +
facet_grid(. ~ year)
gg4 = gg4 + ggtitle("Police Violence in 2015 - Grouped by Race") + xlab('Ethnicity') + ylab("Age") +
theme(legend.position = 'bottom') + scale_fill_discrete(name = 'Ethnicity')
#ggplot(data = filter(police_vio_total, raceethnicity %in% c("White","Black","Hispanic/Latino"), classification %in% c("Gunshot"))) +
#  geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(armed ~ classification)
#ggplot(data = filter(police_vio_total, raceethnicity %in% c("White","Black","Hispanic/Latino"))) +
# geom_bar(aes(x = raceethnicity, fill = raceethnicity), position = 'dodge') + facet_grid(armed ~ classification)
gg5 + geom_text(data = temp, aes(x = long, y = lat, label = state), size = 5) + facet_grid(. ~ year)
gg1
ggplot(data = summarise(group_by(police_vio_total, raceethnicity, year), Year_total = sum(n())) ) +
geom_bar(aes(x = reorder(raceethnicity, Year_total), y = Year_total, fill = raceethnicity ), stat = 'identity') +
facet_grid(. ~ year) + ggtitle('Police Violence - Grouped by year and Race') +
xlab('Ethnicity') + ylab('Total Killed') + theme(legend.position = 'bottom') +
scale_fill_discrete(name = 'Ethnicity')
ggplot(data = summarise(group_by(filter(police_vio_total, raceethnicity %in% c("White", "Black", "Hispanic/Latino"), gender != "Non-conforming"), raceethnicity, year, gender), total = sum(n()) ) )+
geom_bar(aes(x = reorder(raceethnicity, total, mean), y = total, fill = raceethnicity), stat = 'identity', position = 'dodge') +
facet_grid(gender ~ year) +
theme(legend.position = 'bottom') + ggtitle('Police Violence in 2015 & 2016 - Grouped by gender') +
xlab('Ethnicity') + ylab("Total Killed") + scale_fill_discrete(name = "Ethnicity")
gg2
gg3
gg4
